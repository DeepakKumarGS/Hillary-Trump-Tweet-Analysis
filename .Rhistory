ggplot(aes(word, tf_idf, fill = author)) +
geom_col() +
labs(x = NULL, y = "tf-idf") +
coord_flip()
library(ggplot2)
plot_physics %>% top_n(20) %>% ggplot(aes(word, tf_idf, fill = author)) +geom_col() +
labs(x = NULL, y = "tf-idf") +coord_flip()
plot_physics <- physics_words %>% arrange(desc(tf_idf)) %>% mutate(word = factor(word, levels = rev(unique(word)))) %>% mutate(author = factor(author, levels = c("Galilei, Galileo",
"Huygens, Christiaan",
"Tesla, Nikola",
"Einstein, Albert"))
library(ggplot2)
plot_physics %>% top_n(20) %>% ggplot(aes(word, tf_idf, fill = author)) +geom_col() +
labs(x = NULL, y = "tf-idf") +coord_flip()
plot_physics <- physics_words %>% arrange(desc(tf_idf)) %>% mutate(word = factor(word, levels = rev(unique(word)))) %>% mutate(author = factor(author, levels = c("Galilei, Galileo",
"Huygens, Christiaan",
"Tesla, Nikola",
"Einstein, Albert"))
library(ggplot2)
plot_physics %>% top_n(20) %>% ggplot(aes(word, tf_idf, fill = author)) +geom_col() +
labs(x = NULL, y = "tf-idf") +coord_flip()
plot_physics=physics_words %>% arrange(desc(tf_idf)) %>% mutate(word = factor(word, levels = rev(unique(word)))) %>% mutate(author = factor(author, levels = c("Galilei, Galileo","Huygens, Christiaan","Tesla, Nikola","Einstein, Albert"))
library(ggplot2)
plot_physics %>% top_n(20) %>% ggplot(aes(word, tf_idf, fill = author)) +geom_col() +
labs(x = NULL, y = "tf-idf") +coord_flip()
plot_physics=physics_tidy %>% arrange(desc(tf_idf)) %>% mutate(word = factor(word, levels = rev(unique(word)))) %>% mutate(author = factor(author, levels = c("Galilei, Galileo","Huygens, Christiaan","Tesla, Nikola","Einstein, Albert"))
library(ggplot2)
plot_physics %>% top_n(20) %>% ggplot(aes(word, tf_idf, fill = author)) +geom_col() +
labs(x = NULL, y = "tf-idf") +coord_flip()
plot_physics=physics_tidy %>% arrange(desc(tf_idf)) %>% mutate(word = factor(word, levels = rev(unique(word)))) %>% mutate(author = factor(author, levels = c("Galilei, Galileo","Huygens, Christiaan","Tesla, Nikola","Einstein, Albert"))
library(ggplot2)
plot_physics %>% top_n(20) %>% ggplot(aes(word, tf_idf, fill = author)) +geom_col() +
labs(x = NULL, y = "tf-idf") +coord_flip()
plot_physics=physics_tidy %>% arrange(desc(tf_idf)) %>% mutate(word = factor(word, levels = rev(unique(word)))) %>% mutate(author = factor(author, levels = c("Galilei, Galileo","Huygens, Christiaan","Tesla, Nikola","Einstein, Albert"))
plot_physics=physics_tidy %>% arrange(desc(tf_idf)) %>% mutate(word = factor(word, levels = rev(unique(word)))) %>% mutate(author = factor(author, levels = c("Galilei, Galileo","Huygens, Christiaan","Tesla, Nikola","Einstein, Albert")))
plot_physics=physics_tidy %>% arrange(desc(tf_idf)) %>% mutate(word = factor(word, levels = rev(unique(word)))) %>% mutate(author = factor(author, levels = c("Galilei, Galileo","Huygens, Christiaan","Tesla, Nikola","Einstein, Albert")))
View(plot_physics)
plot_physics %>%
top_n(20) %>%
ggplot(aes(word, tf_idf, fill = author)) +
geom_col() +
labs(x = NULL, y = "tf-idf") +
coord_flip()
install.packages(c("acs", "backports", "checkmate", "corrplot", "crayon", "curl", "data.table", "dplyr", "FactoMineR", "forecast", "ggsci", "gridExtra", "irlba", "lme4", "memisc", "openssl", "PKI", "psych", "purrr", "quantmod", "rattle", "Rcpp", "RcppArmadillo", "rgdal", "rgeos", "rJava", "rstudioapi", "tidyr", "tidyselect", "tidytext"))
library(rpart)
library(rpart.plot)
table(iris$Species)
library(ggplot2)
library(tidyverse)
library(plyr)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(knitr)
library(kableExtra)
library(cowplot)
library(tidyr)
library(stringr)
library(zoo)
library(viridis)
library(ggrepel)
library(forcats)
star=read.csv("startup_funding.csv",header=TRUE,stringsAsFactors = FALSE)
star$AmountInUSD=as.numeric(gsub(",","",star$AmountInUSD)) #Changed from char to numeric and removed comma
star$InvestorsName=str_split_fixed(star$InvestorsName,",")
star$InvestorsName=str_split_fixed(star$InvestorsName,",",n=Inf)
View(star)
fruits <- c(
"apples and oranges and pears and bananas",
"pineapples and mangos and guavas"
)
str_split(fruits, " and ")
str_split(fruits, " and ", simplify = TRUE)
str_split(fruits, " and ", n = 3)
str_split(fruits, " and ", n = 2)
star=read.csv("startup_funding.csv",header=TRUE,stringsAsFactors = FALSE)
star$AmountInUSD=as.numeric(gsub(",","",star$AmountInUSD)) #Changed from char to numeric and removed comma
star=star %>% separate(star$InvestorsName,sep=",",extra="merge")
install.packages("splitstackshape")
library(splitstackshape)
star=cSplit(star,"InvestorsName",sep=",",direction="long",drop=FALSE)
temp=ddply(star,.(InvestorsName),summarise,count=n(),sum=sum(AmountInUSD))
View(temp)
temp=ddply(star,.(InvestorsName),summarise,count=n(),sum=sum(AmountInUSD)) %>% arrange(desc(AmountInUSD))
temp=ddply(star,.(InvestorsName),summarise,count=n(),TotalInvestment=sum(AmountInUSD)) %>% arrange(desc(sum))
temp=ddply(star,.(InvestorsName),summarise,count=n(),TotalInvestment=sum(AmountInUSD))
temp=temp %>% arrange(desc(TotalInvestment)) %.% drop_na(TotalInvestment)
temp=temp %>% arrange(desc(TotalInvestment)) %>% drop_na(TotalInvestment)
ggplot(head(temp,10),aes(reorder(InvestorsName,TotalInvestment),TotalInvestment,fill=InvestorsName))+geom_bar(stat="identity")+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Giant Investors !!!")+coord_flip()+scale_y_continuous(labels=scales::comma)
library(plyr)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(knitr)
library(kableExtra)
library(cowplot)
library(tidyr)
library(stringr)
library(zoo)
library(splitstackshape)
library(viridis)
library(ggrepel)
library(forcats)
star=read.csv("startup_fundin
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message=FALSE)
star$AmountInUSD=as.numeric(gsub(",","",star$AmountInUSD)) #Changed from char to numeric and removed comma
star=cSplit(star,"InvestorsName",sep=",",direction="long",drop=FALSE)
star$AmountInUSD=as.numeric(gsub(",","",star$AmountInUSD)) #Changed from char to numeric and removed comma
star=read.csv("startup_funding.csv",header=TRUE,stringsAsFactors = FALSE)
star$AmountInUSD=as.numeric(gsub(",","",star$AmountInUSD)) #Changed from char to numeric and removed comma
star=cSplit(star,"InvestorsName",sep=",",direction="long",drop=FALSE)
temp=ddply(star,.(InvestorsName),summarise,count=n(),TotalInvestment=sum(AmountInUSD))
ggplot(head(temp,10),aes(reorder(InvestorsName,TotalInvestment),TotalInvestment,fill=InvestorsName))+geom_bar(stat="identity")+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Giant Investors !!!")+coord_flip()+scale_y_continuous(labels=scales::comma)
temp=temp %>% arrange(desc(TotalInvestment)) %>% drop_na(TotalInvestment)
ggplot(head(temp,10),aes(reorder(InvestorsName,TotalInvestment),TotalInvestment,fill=InvestorsName))+geom_bar(stat="identity")+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Giant Investors !!!")+coord_flip()+scale_y_continuous(labels=scales::comma)
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorName=="Softbank") %>% select(StartupName,AmountInUSD)
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(StartupName,AmountInUSD)
View(temp)
star =star %>% mutate(StartupName=fct_collapse(StartupName,"Oyo"=c("Oyo","Oyorooms","Oyo Rooms"),"Ola"=c("Ola","Olacabs")))
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(StartupName,AmountInUSD)
View(temp)
View(star)
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(unique(StartupName))
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(unique(star$StartupName))
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(StartupName)
temp= star %>% filter(InvestorsName=="SoftBank Group") %>% select(StartupName)
View(star)
star$StartupName=sapply(strsplit(star$StartupName,split=".com",fixed=TRUE),function(x)(x[1]))
star=read.csv("startup_funding.csv",header=TRUE,stringsAsFactors = FALSE)
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message=FALSE)
library(plyr)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(knitr)
library(kableExtra)
library(cowplot)
library(tidyr)
library(stringr)
library(zoo)
library(splitstackshape)
library(viridis)
library(ggrepel)
library(forcats)
star=read.csv("startup_funding.csv",header=TRUE,stringsAsFactors = FALSE)
glimpse(star)
summary(star)
star$Date=as.POSIXct(strptime(star$Date,format="%d/%m/%Y")) # converting into date format
star$Month=as.factor(format(star$Date,"%m"))
star$Year=as.factor(format(star$Date,"%Y"))
star$Monyr=paste(star$Year,star$Month,sep="-")
temp= star %>% group_by(Monyr) %>% summarise(Investments=n())  # count by month,year
p=ggplot(temp,aes(Monyr,Investments,group=1))+geom_line(color="red",size=1)+theme_dark(base_size=8)+labs(x="Year and Month of Investment",y="Total Investment Count",title="Investment trend over the years")+theme(axis.title=element_text(color="red",family="sans",size=12),axis.text.x = element_text(angle=90,vjust=0.5))# Plot of the year,month trend
#Quaterly trend:
star$Qtr=as.yearqtr(star$Date,format="%y-Q%q")
temp=star %>% group_by(Qtr) %>% summarise(Investment=n()) %>% drop_na(Qtr)
q=ggplot(temp,aes(Qtr,Investment,group=1))+geom_line(color="blue",size=1)+theme_dark(base_size=8)+labs(x="Year and Quarter",y="Total Investment Count",title="Investment trend over the Quarter")+theme(axis.title=element_text(color="red",family="sans",size=12),axis.text.x = element_text(angle=90,vjust=0.5))+scale_x_yearqtr(format="%Y-Q%q")
plot_grid(p,q,ncol=1)
star$AmountInUSD=as.numeric(gsub(",","",star$AmountInUSD)) #Changed from char to numeric and removed comma
temp=ddply(star,.(Qtr),summarise,TotalInvestments=sum(AmountInUSD,na.rm=TRUE))
temp%>% drop_na(Qtr) %>% ggplot(aes(Qtr,TotalInvestments,fill=TotalInvestments))+geom_bar(stat="identity")+labs(x="Quater",y="Total Investment in $",title="Trend of Quarterly Funding")+theme(axis.text.x=element_text(angle=90),legend.position="none")+scale_x_yearqtr(format="%Y-Q%q")+scale_fill_viridis(discrete = FALSE)+scale_y_continuous(labels=scales::comma)
temp=star %>% select(CityLocation) %>% group_by(CityLocation) %>% summarise(count=n()) %>% mutate(perc=round((count/sum(count))*100)) %>% arrange(desc(count)) # Top 10 Cities
temp[temp==""]="CityNotpublished" # replace blank with this
temp$perc=paste(temp$perc,"%") # add % to the column
ggplot(head(temp,10),aes(reorder(CityLocation,count),count,fill=CityLocation))+geom_bar(stat="identity")+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5))+labs(x="",y="Count of Startups",title="Preferred Investment Locations")+geom_label(aes(label=perc))+coord_flip() # visualise along with %
temp=star %>% select(IndustryVertical) %>% group_by(IndustryVertical) %>% drop_na(IndustryVertical)%>% summarise(count=n()) %>% mutate(perc=(count/sum(count))*100) %>% arrange(desc(count))#finding percentage and count
temp$ymax=cumsum(temp$perc) #for donut
temp$ymin=c(0,head(temp$ymax,n=-1))
temp$IndustryVertical=factor(temp$IndustryVertical,levels=temp$IndustryVertical)
ggplot(head(temp,10),aes(fill=IndustryVertical,ymax=ymax,ymin=ymin,xmax=10,xmin=5))+geom_rect(color="black")+coord_polar(theta="y")+xlim(c(0,15))+geom_label_repel(aes(label=paste(round(perc),"%"),x=7,y=(ymax+ymin)/2),inherit.aes=TRUE,show.legend=FALSE)+theme(panel.grid = element_blank(),axis.text = element_blank(),axis.ticks = element_blank(),legend.position="right",axis.title=element_blank()) +annotate("text", x = 0, y = 0 ,label = "Industry Vertical")+labs(fill="IndustrySegment")+guides(fill=guide_legend(keywidth=1,keyheight=1))
unique(star$InvestmentType)
star$InvestmentType=as.factor(star$InvestmentType)
star=star %>% mutate(InvestmentType=fct_collapse(InvestmentType,"PrivateEquity"=c("PrivateEquity","Private Equity"),"SeedFunding"=c("SeedFunding","Seed Funding"),"CrowdFunding"=c("Crowd Funding","Crowd funding")))#rename factor
temp = star %>% group_by(InvestmentType)%>% summarise(count=n()) %>% mutate(perc=(round(count/sum(count)*100,2))) %>% arrange(desc(count))
ggplot(temp,aes(InvestmentType,perc,fill=InvestmentType)) +geom_bar(stat="identity")+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5))+labs(x="",y="Percentage",title="Investment Type")+geom_label(aes(label=perc))+coord_flip()
temp=star %>% select(StartupName,InvestorsName,AmountInUSD) %>% ddply(.(StartupName),summarise,sum=sum(AmountInUSD)) %>% arrange(desc(sum))
kable(head(temp,25),"html") %>% kable_styling("striped",full_width=T) %>% column_spec(1:2,bold=T,background="white") %>% row_spec(c(1,2,3,5,6,24,25),bold=F,color="white",background="#ffb6c1")
star$StartupName=sapply(strsplit(star$StartupName,split=".com",fixed=TRUE),function(x)(x[1]))
star$StartupName=sapply(strsplit(star$StartupName,split=".in",fixed=TRUE),function(x)(x[1]))
star$StartupName=sapply(strsplit(star$StartupName,split=".co",fixed=TRUE),function(x)(x[1]))
star$StartupName=as.factor(star$StartupName)
star =star %>% mutate(StartupName=fct_collapse(StartupName,"Oyo"=c("Oyo","Oyorooms","Oyo Rooms"),"Ola"=c("Ola","Olacabs")))
temp=star %>% select(StartupName,InvestorsName,AmountInUSD) %>% ddply(.(StartupName),summarise,sum=sum(AmountInUSD)) %>% arrange(desc(sum))
#Top 10
ggplot(head(temp,10),aes(reorder(StartupName,sum),sum,fill=StartupName))+geom_bar(stat="identity")+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Investors High Valued Startups")+coord_flip()+scale_y_continuous(labels=scales::comma)
star=cSplit(star,"InvestorsName",sep=",",direction="long",drop=FALSE)
temp=ddply(star,.(InvestorsName),summarise,count=n(),TotalInvestment=sum(AmountInUSD))
temp=temp %>% arrange(desc(TotalInvestment)) %>% drop_na(TotalInvestment)
ggplot(head(temp,10),aes(reorder(InvestorsName,TotalInvestment),TotalInvestment,fill=InvestorsName))+geom_bar(stat="identity")+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Giant Investors !!!")+coord_flip()+scale_y_continuous(labels=scales::comma)
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(StartupName,AmountInUSD)
star =star %>% mutate(StartupName=fct_collapse(StartupName,"Oyo"=c("Oyo","Oyorooms","Oyo Rooms","OyoRooms"),"Ola"=c("Ola","Olacabs","Ola Cabs")))
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(StartupName,AmountInUSD)
View(star)
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(Qtr,StartupName,AmountInUSD)
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(Qtr,StartupName,AmountInUSD) %>% ddply(.(Qtr,StartupName),summarise,TotalInvestment=sum(AmountInUSD))
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(Qtr,StartupName,AmountInUSD) %>% ddply(.(Qtr,StartupName),summarise,TotalInvestment=sum(AmountInUSD),perc=round(TotalInvestment/sum(TotalInvestment)))
temp= star %>% filter(InvestorsName=="SoftBank Group" | InvestorsName=="Softbank") %>% select(Qtr,StartupName,AmountInUSD) %>% ddply(.(Qtr,StartupName),summarise,TotalInvestment=sum(AmountInUSD))
ggplot(temp,aes(x=StartupName,y=AmountInUSD,group=1))+geom_polygon()+coord_polar(theta="x",direction=1)+facet_wrap(~Qtr)
ggplot(temp,aes(x=StartupName,y=TotalInvestment,group=1))+geom_polygon()+coord_polar(theta="x",direction=1)+facet_wrap(~Qtr)
ggplot(temp,aes(x=StartupName,y=TotalInvestment,group=1))+geom_polygon(fill=NA)+coord_polar(theta="x",direction=1)+facet_wrap(~Qtr)
ggplot(temp,aes(x=StartupName,y=TotalInvestment,group=1))+geom_path()+geom_polygon(inherit.aes=TRUE)+coord_polar(theta="x",direction=1)+facet_wrap(~Qtr)
ggplot(temp,aes(x=StartupName,y=TotalInvestment,group=1))+geom_path()+geom_polygon()+coord_polar(theta="x",direction=1)+facet_wrap(~Qtr)
ggplot(temp,aes(x=StartupName,y=TotalInvestment))+geom_path()+geom_polygon()+coord_polar(theta="x",direction=1)+facet_wrap(~Qtr)
ggplot(temp,aes(x=StartupName,y=TotalInvestment))+geom_path()+coord_polar(theta="x",direction=1)+facet_wrap(~Qtr)
ggplot(temp,aes(x=StartupName,y=TotalInvestment,group=StartupName,color=StartupName))+geom_line()+coord_polar(theta="x",direction=1)+facet_wrap(~Qtr)
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity")+facet_wrap(~Qtr)+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity")+facet_wrap(~Qtr,scales=c("free_x","free_y")+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity")+facet_wrap(~Qtr,scales=c("free_x","free_y"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity")+facet_wrap(~Qtr,scales=c("free_x","free_y"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity")+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity")+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")+theme_fivethirtyeight()
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",binwidth = 13)+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")+theme_fivethirtyeight()
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",aes(binwidth = 13))+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")+theme_fivethirtyeight()
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",aes(binwidth = 10))+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")+theme_fivethirtyeight()
ggplot(temp,aes(x=Qtr,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",aes(binwidth = 10))+facet_wrap(~StartupName,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")+theme_fivethirtyeight()+scale_x_yearqtr(format="%Y-%q")
ggplot(temp,aes(x=Qtr,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",aes(binwidth = 10))+facet_wrap(~StartupName,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")+scale_x_yearqtr(format="%Y-%q")
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",aes(binwidth = 10))+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")+scale_x_yearqtr(format="%Y-%q")
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",aes(binwidth = 10))+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",position="identity")+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",position="identity",width=0.5)+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",position="identity",width=0.5)+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")+theme_base()
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",position="identity",width=0.5)+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the Quarter")+theme_fivethirtyeight()
ggplot(temp,aes(x=StartupName,y=TotalInvestment,fill=StartupName))+geom_bar(stat="identity",position="identity",width=0.5)+facet_wrap(~Qtr,scales=c("free"))+scale_y_continuous(labels=scales::comma)+theme(legend.position="none",axis.text.x = element_text(angle=90,vjust=0.5),plot.title=element_text(color="blue",size=10,face="italic"))+labs(x="",y="Total Investment",title="Softbank Investments over the 3 years")+theme_fivethirtyeight()
library(tidyverse)
tidyverse_update()
install.packages(c("checkmate", "data.table", "glue", "lazyeval", "quantreg"))
library(tidyverse)
remove.packages("tidyverse")
install.packages('tidyverse',dependencies = TRUE)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message = FALSE)
library(plyr)
library(tidyverse)
library(formattable)
library(splitstackshape)
library(jsonlite)
movie=read_csv("tmdb_5000_movies.csv",col_names=TRUE,na="NA")
credits=read_csv("tmdb_5000_credits.csv",col_names=TRUE,na="NA")
View(movie)
movie=movie %>% filter(nchar(genres)>2) %>% mutate(js=lapply(genres,fromJSON)) %>% unnest(js)
temp=ddply(movie,-.(id1,name),summarise,id=paste(unique(id1),collapse=","),genres=paste(unique(name),collapse=","))
temp=ddply(movie,.(-id1,-name),summarise,id=paste(unique(id1),collapse=","),genres=paste(unique(name),collapse=","))
temp=ddply(movie,.(-c(id1,name)),summarise,id=paste(unique(id1),collapse=","),genres=paste(unique(name),collapse=","))
temp=ddply(movie,-c(id1,name),summarise,id=paste(unique(id1),collapse=","),genres=paste(unique(name),collapse=","))
temp=aggregate(.~(id1,name),movie,function(x) tostring(unique(x)))
temp=aggregate(.~c(id1,name),movie,function(x) tostring(unique(x)))
temp=aggregate(.~(id1),movie,function(x) tostring(unique(x)))
groupby=c("id1","name")
temp=aggregate(.~groupby,movie,function(x) toString(unique(x)))
temp=aggregate(.~name,movie,function(x) toString(unique(x)))
View(temp)
temp=aggregate(budget~.,data=movie,paste,collapse=",")
View(temp)
temp=aggregate(.~name,data=movie,paste,collapse=",")
temp=aggregate(.~budget,data=movie,paste,collapse=",")
temp=paste(movie[!which(duplicated(movie[,-c(21,22)])),],sep=",")
movie=read_csv("tmdb_5000_movies.csv",col_names=TRUE,na="NA")
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message = FALSE)
movie=read_csv("tmdb_5000_movies.csv",col_names=TRUE,na="NA")
genrejson=rbindlist(fromJSON(movie$genres))
genrejson=bind_cols(movie[,2],stream_in(textConnection(gsub("\\n"," ",movie$genres))))
genrejson=bind_cols(movie[,],stream_in(textConnection(gsub("\\n"," ",movie$genres))))
genrejson=bind_cols(movie[,1],stream_in(textConnection(gsub("\\n"," ",movie$genres))))
genre=movie %>% filter(nchar(genres)>2) %>% mutate(js=lapply(genres,fromJSON)) %>% unnest(js) %>% select(id,title,genre=name)
View(genre)
genre=aggregate(genre~.,movie,paste,collapse=",")
genre=aggregate(genre ~,movie,paste,collapse=",")
genre=aggregate(genre ~.,movie,paste,collapse=",")
genre=aggregate(genre ~.,data=genre,paste,collapse=",")
genre=movie %>% filter(nchar(genres)>2) %>% mutate(js=lapply(genres,fromJSON)) %>% unnest(js) %>% select(id,title,genre=name) #Convert JSON format into data frame
temp=genre %>% group_by(genre) %>% summarise(count=length(genre)) %>% arrange(desc(count))
View(temp)
library(wordcloud)
library(RColorBrewer)
wordcloud(words=temp$genre,freq=temp$count,min.freq=100,max.words = 20,random.order=FALSE,random.color=FALSE,rot.per=0.35,colors = brewer.pal(20,"Dark2"))
wordcloud(words=temp$genre,freq=temp$count,min.freq=100,max.words = 20,random.order=FALSE,random.color=FALSE,rot.per=0.35,colors = brewer.pal(20,"Dark2"),main="Genres Representation")
wordcloud(words=temp$genre,freq=temp$count,min.freq=100,max.words = 20,random.order=FALSE,random.color=FALSE,rot.per=0.35,colors = brewer.pal(20,"Dark2"),scale=1)
wordcloud(words=temp$genre,freq=temp$count,min.freq=100,max.words = 20,random.order=FALSE,random.color=FALSE,rot.per=0.35,colors = brewer.pal(20,"Dark2"),scale=c(4,.5))
wordcloud(words=temp$genre,freq=temp$count,min.freq=100,max.words = 20,random.order=FALSE,random.color=FALSE,rot.per=0.35,colors = brewer.pal(20,"Dark2"),scale=c(2,.5))
wordcloud(words=temp$genre,freq=temp$count,min.freq=100,max.words = 20,random.order=FALSE,random.color=FALSE,rot.per=0.35,colors = brewer.pal(20,"Dark2"),scale=c(4,1))
View(movie)
glimpse(credits)
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message = FALSE)
library(plyr)
library(tidyverse)
library(formattable)
library(splitstackshape)
library(jsonlite)
library(wordcloud)
library(RColorBrewer)
movie=read_csv("tmdb_5000_movies.csv",col_names=TRUE,na="NA")
credits=read_csv("tmdb_5000_credits.csv",col_names=TRUE,na="NA")
genre=movie %>% filter(nchar(genres)>2) %>% mutate(js=lapply(genres,fromJSON)) %>% unnest(js) %>% select(id,title,genre=name) #Convert JSON format into data frame
View(movie)
#genre=aggregate(genre ~.,data=genre,paste,collapse=",") # remove duplicates
temp=genre %>% group_by(genre) %>% summarise(count=length(genre)) %>% arrange(desc(count))#A look at the genre variety in our dataset
#wordcloud
wordcloud(words=temp$genre,freq=temp$count,min.freq=100,max.words = 20,random.order=FALSE,random.color=FALSE,rot.per=0.35,colors = brewer.pal(20,"Dark2"),scale=c(4,1))
library(ggthemes)
movie %>% select(original_title,budget) %>% arrange(desc(budget)) %>% head(10) %>%  ggplot(aes(reorder(original_title,budget),budget,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=45,vjust=0.5),plot.title=element_text(color="Red",face="italics"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Budget Movies -Top 10")
movie %>% select(original_title,budget) %>% arrange(desc(budget)) %>% head(10) %>%  ggplot(aes(reorder(original_title,budget),budget,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=45,vjust=0.5),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Budget Movies -Top 10")
movie %>% select(original_title,budget) %>% drop_na(original_title)%>% arrange(desc(budget)) %>% head(10) %>%  ggplot(aes(reorder(original_title,budget),budget,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=45,vjust=0.5),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Budget Movies -Top 10")
movie %>% select(original_title,budget) %>% drop_na(original_title)%>% arrange(desc(budget)) %>% head(10) %>%  ggplot(aes(reorder(original_title,budget),budget,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=45,vjust=0.1),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Budget Movies -Top 10")
movie %>% select(original_title,budget) %>% drop_na(original_title)%>% arrange(desc(budget)) %>% head(10) %>%  ggplot(aes(reorder(original_title,budget),budget,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=45),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Budget Movies -Top 10")
movie %>% select(original_title,budget) %>% drop_na(original_title)%>% arrange(desc(budget)) %>% head(10) %>%  ggplot(aes(reorder(original_title,budget),budget,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Budget Movies -Top 10")
movie %>% select(original_title,budget) %>% drop_na(original_title)%>% arrange(desc(budget)) %>% head(10) %>%  ggplot(aes(reorder(original_title,budget),budget,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Budget Movies -Top 10")
movie %>% select(original_title,budget) %>% drop_na(original_title)%>% arrange(desc(budget)) %>% head(10) %>%  ggplot(aes(reorder(original_title,budget),budget,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Budget Movies -Top 10")
movie %>% select(original_title,budget) %>% drop_na(original_title)%>% arrange(desc(budget)) %>% head(10) %>%  ggplot(aes(reorder(original_title,budget),budget,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Budget Movies -Top 10")
View(genre)
View(temp)
View(credits)
View(movie)
movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10) %>%  ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Grossing Movies -Top 10")
movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10) %>%  ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(limits=(0,500000000),breaks=seq(0,500000000,150000000),labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Grossing Movies -Top 10")
movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10) %>%  ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(limits=c(0,500000000),breaks=seq(0,500000000,150000000),labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Grossing Movies -Top 10")
temp=movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10)  #ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(limits=c(0,500000000),breaks=seq(0,500000000,150000000),labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Grossing Movies -Top 10")
View(temp)
movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10)  %>% ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(limits=c(0,300000000),breaks=seq(0,300000000,100000000),labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Grossing Movies -Top 10")
movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10)  %>% ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(limits=c(0,300000000),breaks=seq(0,300000000,10000000),labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Grossing Movies -Top 10")
movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10)  %>% ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Budget in $",title="Highest Grossing Movies -Top 10")
movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10)  %>% ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(labels=scales::comma)+labs(x="",y="Total Revenue in $",title="Highest Grossing Movies -Top 10")
movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10)  %>% ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(limits=c(0,3000000000),breaks=seq(0,3000000000,1500000000),labels=scales::comma)+labs(x="",y="Total Revenue in $",title="Highest Grossing Movies -Top 10")
movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10)  %>% ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(limits=c(0,3000000000),breaks=seq(0,3000000000,1000000000),labels=scales::comma)+labs(x="",y="Total Revenue in $",title="Highest Grossing Movies -Top 10")
movie %>% select(original_title,revenue) %>% drop_na(original_title)%>% arrange(desc(revenue)) %>% head(10)  %>% ggplot(aes(reorder(original_title,revenue),revenue,fill=original_title))+geom_bar(stat="identity")+theme(axis.text.x = element_text(angle=90),plot.title=element_text(color="Red",face="italic"),legend.position="none")+scale_y_continuous(limits=c(0,3000000000),breaks=seq(0,3000000000,500000000),labels=scales::comma)+labs(x="",y="Total Revenue in $",title="Highest Grossing Movies -Top 10")
View(genre)
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message = FALSE)
library(plyr)
library(tidyverse)
library(formattable)
library(splitstackshape)
library(jsonlite)
library(wordcloud)
library(RColorBrewer)
library(ggthemes)
library(tm)
library(RSentiment)
movie=read_csv("tmdb_5000_movies.csv",col_names=TRUE,na="NA")
credits=read_csv("tmdb_5000_credits.csv",col_names=TRUE,na="NA")
View(movie)
library(zoo)
class(movie$release_date)
movie$Year=as.factor(format(movie$release_date,"%Y"))
View(movie)
movie$Date=as.factor(format(movie$release_date,"%d"))
movie$month=as.factor(format(movie$release_date,"M"))
movie$month=as.factor(format(movie$release_date,"%M"))
movie$month=as.factor(format(movie$release_date,"%m"))
movie$month=month.abb(as.factor(format(movie$release_date,"%m")))
movie$month=month.abb[(as.factor(format(movie$release_date,"%m")))]
movie %>% group_by(month) %>% summarise(count=n()) %>% arrange(desc(month)) %>% ggplot(aes(reorder(month,count),count,fill=month))+geom_bar(stat="identity")+theme(plot.title=element_text(size=14,face="italic",colour="red",family="bold"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Total number of movies released",title="Number of Movies Releases per month")+coord_flip()
movie %>% group_by(month) %>% sdrop_na(month) %>% ummarise(count=n()) %>% arrange(desc(month)) %>% ggplot(aes(reorder(month,count),count,fill=month))+geom_bar(stat="identity")+theme(plot.title=element_text(size=14,face="italic",colour="red",family="bold"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Total number of movies released",title="Number of Movies Releases per month")+coord_flip()
movie %>% group_by(month) %>% drop_na(month) %>% ummarise(count=n()) %>% arrange(desc(month)) %>% ggplot(aes(reorder(month,count),count,fill=month))+geom_bar(stat="identity")+theme(plot.title=element_text(size=14,face="italic",colour="red",family="bold"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Total number of movies released",title="Number of Movies Releases per month")+coord_flip()
movie %>% group_by(month) %>% drop_na(month) %>% summarise(count=n()) %>% arrange(desc(month)) %>% ggplot(aes(reorder(month,count),count,fill=month))+geom_bar(stat="identity")+theme(plot.title=element_text(size=14,face="italic",colour="red",family="bold"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Total number of movies released",title="Number of Movies Releases per month")+coord_flip()
movie %>% group_by(month) %>% drop_na(month) %>% summarise(count=n()) %>% arrange(desc(month)) %>% ggplot(aes(reorder(month,count),count,fill=month))+geom_bar(stat="identity")+theme(plot.title=element_text(size=14,face="italic",colour="red",family="bold"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Total number of movies released",title="Number of Movies Releases per month")+coord_flip()+geom_text(aes(label=count,hjust=0.5,color="black"))
movie %>% group_by(month) %>% drop_na(month) %>% summarise(count=n()) %>% arrange(desc(month)) %>% ggplot(aes(reorder(month,count),count,fill=month))+geom_bar(stat="identity")+theme(plot.title=element_text(size=14,face="italic",colour="red",family="bold"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Total number of movies released",title="Number of Movies Releases per month")+coord_flip()+geom_text(aes(label=count))
movie %>% group_by(month) %>% drop_na(month) %>% summarise(count=n()) %>% arrange(desc(month)) %>% ggplot(aes(reorder(month,count),count,fill=month))+geom_bar(stat="identity")+theme(plot.title=element_text(size=14,face="italic",colour="red",family="bold"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Total number of movies released",title="Number of Movies Releases per month")+coord_flip()+geom_label(aes(label=count))
movie %>% group_by(month) %>% drop_na(month) %>% summarise(count=n()) %>% arrange(desc(month)) %>% ggplot(aes(reorder(month,count),count,fill=month))+geom_bar(stat="identity")+theme(plot.title=element_text(size=14,face="italic",colour="red"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Total number of movies released",title="Number of Movies Releases per month")+coord_flip()+geom_label(aes(label=count))
ggplot(movie,aes(month,vote_average,fill=month))+geom_boxplot(outlier.colour = "red")+theme(plot.title=element_text(size=14,face="italic",colour="red"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Average Vote",title="Boxplot of Average votes received by month")
ggplot(movie,aes(month,vote_average,fill=month))+geom_boxplot(outlier.colour = "red")+theme(plot.title=element_text(size=14,face="italic",colour="red"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Average Vote",title="Boxplot of Average votes received by month")+coord_flip()
ggplot(movie,aes(month,vote_average,fill=month))+geom_boxplot(outlier.colour = "red",na.rm=TRUE)+theme(plot.title=element_text(size=14,face="italic",colour="red"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Average Vote",title="Boxplot of Average votes received by month")+coord_flip()
movie %>% drop_na(month) %>% ggplot(aes(month,vote_average,fill=month))+geom_boxplot(outlier.colour = "red",na.rm=TRUE)+theme(plot.title=element_text(size=14,face="italic",colour="red"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Average Vote",title="Boxplot of Average votes received by month")+coord_flip()
movie %>% drop_na(month) %>% ggplot(aes(month,vote_average,fill=month))+geom_boxplot(outlier.colour = "red",na.rm=TRUE)+theme(plot.title=element_text(size=14,face="italic",colour="red"),axis.text.x = element_text(angle=90),legend.position="none")+labs(x="",y="Average Vote",title="Boxplot of Average votes received by month")+coord_flip()
temp=movie %>% group_by(month) %>% mutate(median=median(vote_average),low=min(vote_average),high=max(vote_average))
View(temp)
temp=movie %>% select(month,vote_average) %>% ddply(.(month),summary,median=median(vote_average),low=min(vote_average),high=max(vote_average))
View(temp)
temp= ddply(movie,.(month),summary,median=median(vote_average),low=min(vote_average),high=max(vote_average))
View(temp)
temp= ddply(movie,.(month),aggregate,median=median(vote_average),low=min(vote_average),high=max(vote_average))
temp=movie %>% group_by(month) %>% summarise(median=median(vote_average),low=min(vote_average),high=max(vote_average))
View(temp)
temp=movie %>% group_by(month) %>% filter(vote_average!=0)%>%  summarise(median=median(vote_average),low=min(vote_average),high=max(vote_average))
View(temp)
temp=movie %>% group_by(month) %>% filter(vote_average!=0)%>%  summarise(median=median(vote_average),low=min(vote_average),high=max(vote_average)) %>% mutate(score=paste("low","/","high"))
View(temp)
temp=movie %>% group_by(month) %>% filter(vote_average!=0)%>%  summarise(median=median(vote_average),low=min(vote_average),high=max(vote_average)) %>% mutate(score=paste(low,"/",high))
temp=movie %>% group_by(month) %>% filter(vote_average!=0)%>%  summarise(median=median(vote_average),low=min(vote_average),high=max(vote_average)) %>% mutate(score=paste(low,"/",high)) %>% arrange(month)
temp=movie %>% group_by(month) %>% filter(vote_average!=0)%>%  summarise(median=median(vote_average),low=min(vote_average),high=max(vote_average)) %>% mutate(score=paste(low,"/",high)) %>% arrange(factor(month))
temp=movie %>% group_by(month) %>% filter(vote_average!=0)%>%  summarise(median=median(vote_average),low=min(vote_average),high=max(vote_average)) %>% mutate(score=paste(low,"/",high)) %>% arrange(factor(month,level=month.name))
temp=movie %>% group_by(month) %>% filter(vote_average!=0)%>%  summarise(median=median(vote_average),low=min(vote_average),high=max(vote_average)) %>% mutate(score=paste(low,"/",high)) %>% sort(factor(month,level=month.name))
class(movie$month)
movie$month=factor(month,level=month.name)
movie$month=factor(movie$month,level=month.name)
temp=movie %>% group_by(month) %>% filter(vote_average!=0)%>%  summarise(median=median(vote_average),low=min(vote_average),high=max(vote_average)) %>% mutate(score=paste(low,"/",high))
movie$month=factor(movie$month,level=month.name,ifany(is.na(movie$month)))
movie$month=factor(movie$month,level=month.name,exclude="NA")
temp=movie %>% group_by(month) %>% filter(vote_average!=0)%>%  summarise(median=median(vote_average),low=min(vote_average),high=max(vote_average)) %>% mutate(score=paste(low,"/",high))
movie=read_csv("tmdb_5000_movies.csv",col_names=TRUE,na="NA")
install.packages("DiagrammeR")
library(DiagrammeR)
mermaid("
gantt
dateFormat  YYYY-MM-DD
title A Very Nice Gantt Diagram
section Basic Tasks
This is completed             :done,          first_1,    2014-01-06, 2014-01-08
This is active                :active,        first_2,    2014-01-09, 3d
Do this later                 :               first_3,    after first_2, 5d
Do this after that            :               first_4,    after first_3, 5d
section Important Things
Completed, critical task      :crit, done,    import_1,   2014-01-06,24h
Also done, also critical      :crit, done,    import_2,   after import_1, 2d
Doing this important task now :crit, active,  import_3,   after import_2, 3d
Next critical task            :crit,          import_4,   after import_3, 5d
section The Extras
First extras                  :active,        extras_1,   after import_4,  3d
Second helping                :               extras_2,   after extras_1, 20h
More of the extras            :               extras_3,   after extras_1, 48h
")
library(haven)
quiz_1_marks_spartans <- read_sav("~/my files/Great Lakes Files/Courses/Residency 2/Advanced Statistics/practice data/quiz 1 marks spartans.sav")
View(quiz_1_marks_spartans)
library(tidyr)
anovatab=aov(quiz_1_marks_spartans$q1marks~quiz_1_marks_spartans$Section)
quiz_1_marks_spartans$Section=as.factor(quiz_1_marks_spartans$Section)
TukeyHSD(anovatab,conf.level=0.95)
quiz_1_marks_spartans$Section=as.factor(quiz_1_marks_spartans$Section)
anovatab=aov(quiz_1_marks_spartans$q1marks~quiz_1_marks_spartans$Section)
summary(anovatab)
TukeyHSD(anovatab,conf.level=0.95)
anovatab
store_promo_data_anova <- read_sav("~/my files/Great Lakes Files/Courses/Residency 2/Advanced Statistics/practice data/store promo data anova.sav")
str(store_promo_data_anova)
store_promo_data_anova$clirate=NULL
store_promo_data_anova$coupon=as.factor(store_promo_data_anova$coupon)
store_promo_data_anova$ispromo=as.factor(store_promo_data_anova$ispromo)
plot(sales~coupon+ispromo+coupon:ispromo,data=store_promo_data_anova)
interaction.plot(store_promo_data_anova$coupon,store_promo_data_anova$ispromo,store_promo_data_anova$sales,fun=mean)
res=aov(sales~coupon+ispromo+coupon:ispromo,data=store_promo_data_anova)
res
summary(res)
promo_merchandising_data_anova <- read_sav("~/my files/Great Lakes Files/Courses/Residency 2/Advanced Statistics/practice data/promo merchandising data anova.sav")
str(promo_merchandising_data_anova)
promo_merchandising_data_anova$merchand=as.factor(promo_merchandising_data_anova$merchand)
promo_merchandising_data_anova$promo=as.factor(promo_merchandising_data_anova$promo)
promo_merchandising_data_anova$weather=as.factor(promo_merchandising_data_anova$weather)
interaction.plot(promo_merchandising_data_anova$merchand,promo_merchandising_data_anova$promo,promo_merchandising_data_anova$sales,fun=mean)
plot(sales~merchand+promo+weather,data=promo_merchandising_data_anova)
res=aov(sales~merchand+promo+merchand:promo,data=promo_merchandising_data_anova)
summary(res)
comp_ad_covariate_data <- read_sav("~/my files/Great Lakes Files/Courses/Residency 2/Advanced Statistics/practice data/comp ad covariate data.sav")
comp_ad_covariate_data$compadfo=as.factor(comp_ad_covariate_data$compadfo)
comp_ad_covariate_data$compstra=as.factor(comp_ad_covariate_data$compstra)
res=aov(Manipint~compadfo+compstra+compadfo:compstra,data=comp_ad_covariate_data)
summary(res)
interaction.plot(comp_ad_covariate_data$compadfo,comp_ad_covariate_data$compstra,comp_ad_covariate_data$Manipint,fun=mean)
library(QuantPsyc)
page_575_data <- read_sav("~/my files/Great Lakes Files/Courses/Residency 2/Advanced Statistics/practice data/page 575 data.sav")
str(page_575_data)
res=lm(snprefer~comfort+style+durable,data=page_575_data)
lm.beta(res)
summary(res)
sari_preference_dummy_data <- read_sav("~/my files/Great Lakes Files/Courses/Residency 2/Advanced Statistics/practice data/sari preference dummy data.sav")
sari_preference_dummy_data$colour=as.factor(sari_preference_dummy_data$colour)
sari_preference_dummy_data$saripref=as.numeric(sari_preference_dummy_data$saripref)
sari_preference_dummy_data$price=as.numeric(sari_preference_dummy_data$price)
sari_preference_dummy_data$quality=as.numeric(sari_preference_dummy_data$quality)
a=contrasts(sari_preference_dummy_data$colour)
a
contrasts(sari_preference_dummy_data$colour)=contr.treatment(3)
res=lm(saripref~colour+price+quality,data=sari_preference_dummy_data)
summary(res)
lm.beta(res)
setwd("~/Downloads/R/Clinton Trump Tweets/Hillary-Trump-Tweet-Analysis")
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message=FALSE)
library(lubridate)
library(ggplot2)
library(dplyr)
library(tidytext)
library(tm)
library(wordcloud)
library(readr)
library(tidyr)
library(RColorBrewer)
library(stringr)
library(RSentiment)
library(cowplot)
library(ggthemes)
library(knitr)
library(kableExtra)
tweets=read.csv("tweets.csv",header=TRUE,stringsAsFactors = FALSE)
summary(tweets)
tweets$time=ymd_hms(tweets$time)
tweets$year=as.numeric(year(tweets$time))
tweets$month=as.numeric(month(tweets$time))
tweets$clock=as.numeric(hour(tweets$time))
ggplot(tweets,aes(month,fill=handle))+geom_histogram(binwidth=1,aes(y=..count..))+facet_wrap(~handle,ncol=1,scales="free")+scale_x_continuous(limits=c(1,12),breaks=seq(1,12,1))
temp=tweets  %>%  filter(!(is_retweet=="True")) %>% select(handle,clock)
temp=temp %>% group_by(handle,clock) %>% tally()
ggplot(temp,aes(clock,n,fill=handle,color=handle))+geom_point()+geom_line()+theme(legend.position="bottom",plot.title=element_text(hjust=0.5))+labs(x="Time(Hrs)",y="Tweet Count",title="Tweet Distribution by Time")+scale_x_continuous(limits=c(0,23),breaks=seq(0,23,1))
ggsave("tweettime.jpeg")
temp=subset(tweets,!(is.na(tweets$text)))
temp=as.data.frame(clean(temp))
clean=function(x){
x$text=str_replace_all(x$text,'[^[:alnum:]]',' ')
x$text=gsub("[[:digit:]]"," ",x$text)
x$text=gsub("[\t]{2,}"," ",x$text)
x$text=gsub("https.*"," ",x$text)
return(x)
}
temp=subset(tweets,!(is.na(tweets$text)))
temp=as.data.frame(clean(temp))
temp=temp %>% unnest_tokens(word,text) %>% count(handle,word,sort=TRUE) %>% ungroup()
total_words=temp %>% group_by(handle) %>% summarise(count=n())
temp=left_join(temp,total_words)
kable(head(temp,20),"html") %>% kable_styling(bootstrap_options="condensed",position="center")
ggplot(temp,aes(n/count,fill=handle))+geom_histogram(show.legend = FALSE)+facet_wrap(~handle,scales="free")+xlim(NA,0.0030)+labs(x="TF",y="Count",title="Term Frequency for Each Handle")
temp=temp %>% filter(!(is.na(handle))) %>% bind_tf_idf(word,handle,n)
temp1=temp %>% select(-count) %>% arrange(desc(tf_idf)) %>% mutate(word=factor(word,levels=rev(unique(word))))
temp1 %>% group_by(handle) %>% top_n(20) %>% ungroup() %>% ggplot(aes(word,tf_idf,fill=handle))+geom_col(show.legend=FALSE)+labs(x="",y="tf-idf",title="Top 20 Words")+facet_wrap(~handle,ncol=2,scales="free")+coord_flip()
ggplot("top20.jpeg")
ggsave("top20.jpeg")
